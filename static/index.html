<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4-Panel Manga Generator</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>4-Panel Manga Generator</h1>
            <p>Generate manga panels using Google Gemini AI</p>
        </header>

        <main>
            <!-- Usage Instructions -->
            <section class="section">
                <details open>
                    <summary><h2 style="display: inline;">How to Use / ä½¿ã„æ–¹</h2></summary>
                    <div class="instructions">
                        <h3>ğŸ“– Basic Usage / åŸºæœ¬çš„ãªä½¿ã„æ–¹</h3>
                        <ol>
                            <li>
                                <strong>(Optional) Upload or select a layout reference image</strong><br>
                                <strong>ï¼ˆä»»æ„ï¼‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¾ãŸã¯é¸æŠ</strong><br>
                                <em>â†’ The AI will follow this layout exactly / AIã¯ã“ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«å³å¯†ã«å¾“ã„ã¾ã™</em>
                            </li>
                            <li>
                                <strong>Add characters</strong> and select their reference images<br>
                                <strong>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’è¿½åŠ </strong>ã—ã€ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç”»åƒã‚’é¸æŠ
                            </li>
                            <li>
                                <strong>Fill in scene descriptions</strong> for each of the 4 panels<br>
                                4ã¤ã®ãƒ‘ãƒãƒ«ãã‚Œãã‚Œã®<strong>ã‚·ãƒ¼ãƒ³èª¬æ˜ã‚’å…¥åŠ›</strong>
                            </li>
                            <li>
                                <strong>Click "Generate Image"</strong> and wait for the result<br>
                                <strong>ã€ŒGenerate Imageã€ã‚’ã‚¯ãƒªãƒƒã‚¯</strong>ã—ã¦çµæœã‚’å¾…ã¤
                            </li>
                        </ol>

                        <h3>âš ï¸ Important Notes / é‡è¦ãªæ³¨æ„äº‹é …</h3>
                        <ul>
                            <li>
                                <strong>Output aspect ratio is fixed to 3:4 (Portrait)</strong><br>
                                <strong>å‡ºåŠ›ç”»åƒã®ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã¯3:4ï¼ˆç¸¦é•·ï¼‰ã«å›ºå®šã•ã‚Œã¦ã„ã¾ã™</strong><br>
                                <em>â†’ This ensures optimal compatibility with layout references / ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¨ã®æœ€é©ãªäº’æ›æ€§ã‚’ç¢ºä¿ã—ã¾ã™</em>
                            </li>
                            <li>
                                <strong>Speech bubbles will be EMPTY</strong> (no dialogue text)<br>
                                <strong>å¹ãå‡ºã—ã¯ç©ºç™½ã«ãªã‚Šã¾ã™</strong>ï¼ˆã‚»ãƒªãƒ•ãƒ†ã‚­ã‚¹ãƒˆã¯å…¥ã‚Šã¾ã›ã‚“ï¼‰<br>
                                <em>â†’ You can add text later / å¾Œã§ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿½åŠ ã§ãã¾ã™</em>
                            </li>
                            <li>
                                <strong>No text will be generated</strong> (no sound effects, no words)<br>
                                <strong>ãƒ†ã‚­ã‚¹ãƒˆã¯ç”Ÿæˆã•ã‚Œã¾ã›ã‚“</strong>ï¼ˆåŠ¹æœéŸ³ã‚„æ–‡å­—ã¯å…¥ã‚Šã¾ã›ã‚“ï¼‰<br>
                                <em>â†’ Only manga symbols (!, ?, â™ª, etc.) may appear / æ¼«ç”»è¨˜å·ï¼ˆï¼ã€ï¼Ÿã€â™ªãªã©ï¼‰ã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™</em>
                            </li>
                            <li>
                                <strong>Layout reference is strictly followed</strong> when provided<br>
                                <strong>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¯å³å¯†ã«éµå®ˆã•ã‚Œã¾ã™</strong>ï¼ˆæä¾›ã•ã‚ŒãŸå ´åˆï¼‰<br>
                                <em>â†’ Panel positions, sizes, and arrangement will match exactly within the 3:4 canvas / 3:4ã‚­ãƒ£ãƒ³ãƒã‚¹å†…ã§ãƒ‘ãƒãƒ«ã®ä½ç½®ã€ã‚µã‚¤ã‚ºã€é…ç½®ãŒæ­£ç¢ºã«ä¸€è‡´ã—ã¾ã™</em>
                            </li>
                            <li>
                                <strong>Character consistency is maintained</strong> across panels<br>
                                <strong>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ä¸€è²«æ€§ã¯ç¶­æŒã•ã‚Œã¾ã™</strong>ï¼ˆå…¨ãƒ‘ãƒãƒ«ã‚’é€šã—ã¦ï¼‰<br>
                                <em>â†’ Based on the reference images provided / æä¾›ã•ã‚ŒãŸãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç”»åƒã«åŸºã¥ãã¾ã™</em>
                            </li>
                            <li>
                                <strong>Full-color flat illustration style</strong><br>
                                <strong>ãƒ•ãƒ«ã‚«ãƒ©ãƒ¼ã®ãƒ•ãƒ©ãƒƒãƒˆã‚¤ãƒ©ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«</strong><br>
                                <em>â†’ Characters are emphasized with vibrant colors and thicker lines / ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¯é®®ã‚„ã‹ãªè‰²ã¨å¤ªã„ç·šã§å¼·èª¿ã•ã‚Œã¾ã™</em>
                            </li>
                        </ul>

                        <h3>ğŸ’¡ Tips / ãƒ’ãƒ³ãƒˆ</h3>
                        <ul>
                            <li>
                                <strong>Use clear, descriptive scene descriptions</strong> for best results<br>
                                æœ€è‰¯ã®çµæœã‚’å¾—ã‚‹ãŸã‚ã«<strong>æ˜ç¢ºã§èª¬æ˜çš„ãªã‚·ãƒ¼ãƒ³èª¬æ˜ã‚’ä½¿ç”¨</strong>ã—ã¦ãã ã•ã„
                            </li>
                            <li>
                                <strong>Character reference images</strong> help maintain visual consistency<br>
                                <strong>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç”»åƒ</strong>ã«ã‚ˆã‚Šè¦–è¦šçš„ãªä¸€è²«æ€§ãŒä¿ãŸã‚Œã¾ã™
                            </li>
                            <li>
                                <strong>Layout reference is highly recommended</strong> for professional results<br>
                                ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªçµæœã‚’å¾—ã‚‹ãŸã‚ã«<strong>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ä½¿ç”¨ã‚’å¼·ãæ¨å¥¨</strong>ã—ã¾ã™
                            </li>
                        </ul>
                    </div>
                </details>
            </section>

            <!-- Image Settings -->
            <section class="section">
                <h2>Image Settings</h2>
                <div class="form-group">
                    <label>Aspect Ratio:</label>
                    <div class="fixed-setting">
                        <strong>3:4 (Portrait)</strong>
                        <small>Fixed aspect ratio to ensure layout reference compatibility / ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¨ã®äº’æ›æ€§ã®ãŸã‚å›ºå®š</small>
                    </div>
                </div>
            </section>

            <!-- Reference Images -->
            <section class="section">
                <h2>Reference Images</h2>

                <!-- Layout Reference -->
                <div class="form-group">
                    <label>Layout Reference:</label>
                    <select id="layoutRefSelect">
                        <option value="">-- Select from existing --</option>
                    </select>
                    <input type="file" id="layoutRefUpload" accept="image/*">
                    <small>Select an existing layout or upload a new one</small>
                </div>

                <!-- Characters -->
                <div id="charactersContainer">
                    <h3>Characters</h3>
                    <div id="charactersList"></div>
                    <button type="button" id="addCharacterBtn" class="btn btn-secondary">+ Add Character</button>
                </div>
            </section>

            <!-- 4 Panels -->
            <section class="section">
                <h2>4-Panel Scenes</h2>
                <div id="scenesContainer"></div>
            </section>

            <!-- Generate Button -->
            <div class="actions">
                <button type="button" id="generateBtn" class="btn btn-primary">Generate Image</button>
            </div>

            <!-- Loading State -->
            <div id="loadingState" class="loading-state hidden">
                <div class="spinner"></div>
                <p>Generating manga panels...</p>
            </div>

            <!-- Results -->
            <section id="resultsSection" class="section hidden">
                <h2>Results</h2>

                <!-- Thought Process (Collapsible) -->
                <details id="thoughtProcessDetails">
                    <summary>Thought Process</summary>
                    <div id="thoughtProcessContent" class="thought-process"></div>
                </details>

                <!-- Generated Image -->
                <div id="generatedImageContainer" class="hidden">
                    <img id="generatedImage" alt="Generated manga panel">
                    <div class="actions">
                        <a id="downloadBtn" class="btn btn-secondary" download="manga-panel.png">Download Image</a>
                        <button type="button" id="retryFromThoughtBtn" class="btn btn-secondary">Retry from Thought</button>
                        <button type="button" id="retryImageOnlyBtn" class="btn btn-secondary">Retry Image Only</button>
                    </div>
                </div>

                <!-- Error Message -->
                <div id="errorMessage" class="error-message hidden"></div>
            </section>
        </main>

        <footer>
            <p>Powered by Google Gemini API</p>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
